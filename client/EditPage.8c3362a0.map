{"version":3,"sources":["components/edit/Textfield.vue","components/edit/Textarea.vue","components/edit/Froala.vue","components/edit/Media.vue","components/edit/Number.vue","components/edit/Boolean.vue","components/edit/Collection.vue","components/EditPage.vue"],"names":[],"mappings":"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","file":"EditPage.8c3362a0.map","sourceRoot":"..\\vue","sourcesContent":["<template lang=\"pug\">\nmdc-textfield(:label=\"label\", v-model=\"model\")\n</template>\n\n<script>\nexport default {\n  props: {\n    label: String,\n    value: String,\n  },\n  computed: {\n    model: {\n      get() {\n        return this.value;\n      },\n      set(value) {\n        this.$emit('input', value);\n      }\n    }\n  },\n};\n</script>\n","<template lang=\"pug\">\nmdc-textfield(multiline, cols=\"100\", rows=\"100\", :label=\"label\", v-model=\"model\")\n</template>\n\n<script>\nexport default {\n  props: {\n    label: String,\n    value: String,\n  },\n  computed: {\n    model: {\n      get() {\n        return this.value;\n      },\n      set(value) {\n        this.$emit('input', value);\n      }\n    }\n  },\n};\n</script>\n","<template lang=\"pug\">\nmdc-textfield(multiline, :label=\"label\", v-model=\"model\")\n</template>\n\n<script>\nexport default {\n  props: {\n    label: String,\n    value: String,\n  },\n  computed: {\n    model: {\n      get() {\n        return this.value;\n      },\n      set(value) {\n        this.$emit('input', value);\n      }\n    }\n  },\n};\n</script>\n","<template lang=\"pug\">\n.media\n  h3 Not yet finished\n</template>\n\n<script>\nexport default {\n  props: {\n    label: String,\n    value: String,\n  },\n};\n</script>\n","<template lang=\"pug\">\n.number\n  h3 Not yet finished\n</template>\n\n<script>\nexport default {\n  props: {\n    label: String,\n    value: String,\n  },\n};\n</script>\n","<template lang=\"pug\">\r\nmdc-form-field(:label=\"label\")\r\n  mdc-checkbox(v-model=\"model\")\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  model: {\r\n    event: 'changed',\r\n    prop: 'checked'\r\n  },\r\n  props: {\r\n    label: String,\r\n    checked: Boolean,\r\n  },\r\n\r\n  computed: {\r\n    model: {\r\n      get() {\r\n        return this.checked;\r\n      },\r\n      set(checked) {\r\n        this.$emit('changed', checked);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n","<template lang=\"pug\">\n.collection\n  h3 Not yet finished\n</template>\n\n<script>\nexport default {\n  props: {\n    label: String,\n    value: String,\n  },\n};\n</script>\n","<template lang=\"pug\">\n.edit-page\n  h2 Editing page: {{ slug }}\n\n  mdc-textfield(v-model=\"label\", label=\"Sidonamn\")\n  .controls\n    mdc-form-field(label=\"Publicerad\")\n      mdc-checkbox(v-model=\"published\")\n    mdc-button(@click=\"save\") Spara ändringar\n\n  .fields\n    .field(v-for=\"(field, name) of fields\")\n      span.slug Fältnamn: {{ name }}\n      component(:is=\"field.is\", :label=\"field.label\", v-model=\"field.value\")\n</template>\n\n<script>\nimport EditTextfield from './edit/Textfield.vue';\nimport EditTextarea from './edit/Textarea.vue';\nimport EditFroala from './edit/Froala.vue';\nimport EditMedia from './edit/Media.vue';\nimport EditNumber from './edit/Number.vue';\nimport EditBoolean from './edit/Boolean.vue';\nimport EditCollection from './edit/Collection.vue';\n\nconst FIELDS = {\n  paragraph: 'textfield',\n  text: 'textarea',\n  wysiwyg: 'froala',\n  html: 'textarea',\n  media: 'media',\n  number: 'number',\n  boolean: 'boolean',\n  collection: 'collection'\n};\n\nexport default {\n  name: 'CmsEditPage',\n  components: {\n    EditTextfield,\n    EditTextarea,\n    EditFroala,\n    EditMedia,\n    EditNumber,\n    EditBoolean,\n    EditCollection,\n  },\n  props: {},\n\n  data() {\n    return {\n      label: '',\n      published: false,\n      fields: {},\n    };\n  },\n  computed: {\n    slug() {\n      return this.$route.params.page;\n    },\n  },\n\n  async created() {\n    const token = this.$auth.token;\n\n    // Call api function to get current pages\n    try {\n      const page = await this.$api(`/page/${this.slug}`);\n      // Add is prop to field\n      Object.keys(page.fields).forEach(key => {\n        const field = page.fields[key];\n        field.is = `edit-${FIELDS[field.type]}`;\n      });\n\n      this.fields = page.fields;\n      this.published = page.published;\n      this.label = page.label;\n    } catch(ex) {\n      this.$snackbar.show(ex.message);\n    }\n  },\n  methods: {\n    async save() {\n      const token = this.$auth.token;\n\n      // Call api function to save changes\n      try {\n        const fields = Object.keys(this.fields).reduce((fields, key) => {\n          const { is, ...newField} = this.fields[key];\n          fields[key] = newField;\n          return fields;\n        }, {});\n\n        const page = await this.$api(`/page/${this.slug}`, {\n          method: 'post',\n          body: {\n            data: {\n              fields,\n              published: this.published,\n              label: this.label,\n            }\n          },\n        });\n\n        this.$snackbar.show('Ändringarna sparades');\n      } catch(ex) {\n        this.$snackbar.show(ex.message);\n      }\n    }\n  },\n};\n</script>\n"]}