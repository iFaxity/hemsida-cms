{"version":3,"sources":["components/Pages.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAgBA;AACA,EAAA,IAAA,EAAA,UADA;;AAEA,EAAA,IAAA,GAAA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,EADA;AAEA,MAAA,MAAA,EAAA;AACA,QAAA,IAAA,EAAA,EADA;AAEA,QAAA,KAAA,EAAA;AAFA;AAFA,KAAA;AAOA,GAVA;;AAWA,EAAA,QAAA,EAAA;AACA,IAAA,WAAA,GAAA;AACA,YAAA;AAAA,QAAA;AAAA,UAAA,IAAA,CADA,CAEA;;AACA,UAAA,MAAA,CAAA,KAAA,CAAA,MAAA,GAAA,EAAA,IAAA,MAAA,CAAA,IAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA,eAAA,CAAA,KAAA,KAAA,CAAA,IAAA,CAAA,IAAA,IAAA,IAAA,CAAA,IAAA,IAAA,MAAA,CAAA,IAAA,CAAA;AACA;;AACA,aAAA,KAAA;AACA;;AARA,GAXA;;AAsBA,QAAA,OAAA,GAAA;AACA,UAAA,KAAA,GAAA,KAAA,KAAA,CAAA,KAAA,CADA,CAGA;;AACA,QAAA;AACA,WAAA,KAAA,GAAA,MAAA,KAAA,IAAA,CAAA,OAAA,CAAA;AACA,KAFA,CAEA,OAAA,EAAA,EAAA;AACA,WAAA,SAAA,CAAA,IAAA,CAAA,EAAA,CAAA,OAAA;AACA;AACA,GA/BA;;AAiCA,EAAA,OAAA,EAAA;AACA,IAAA,YAAA,GAAA;AACA,WAAA,KAAA,CAAA,MAAA,CAAA,IAAA;AACA,KAHA;;AAIA,UAAA,UAAA,GAAA;AACA,YAAA;AAAA,QAAA;AAAA,UAAA,IAAA;;AAEA,UAAA;AACA,cAAA,KAAA,IAAA,CAAA,SAAA,MAAA,CAAA,IAAA,EAAA,EAAA;AACA,UAAA,MAAA,EAAA,KADA;AAEA,UAAA,IAAA,EAAA;AACA,YAAA,IAAA,EAAA;AAAA,cAAA,KAAA,EAAA,MAAA,CAAA;AAAA;AADA;AAFA,SAAA,CAAA;AAQA,QAAA,MAAA,CAAA,IAAA,GAAA,EAAA;AACA,QAAA,MAAA,CAAA,KAAA,GAAA,EAAA;AACA,aAAA,SAAA,CAAA,IAAA,CAAA,gBAAA;AACA,OAZA,CAYA,OAAA,EAAA,EAAA;AACA,aAAA,SAAA,CAAA,IAAA,CAAA,EAAA,CAAA,OAAA;AACA;AACA,KAtBA;;AAuBA,IAAA,QAAA,CAAA,IAAA,EAAA;AACA,WAAA,OAAA,CAAA,IAAA,CAAA,cAAA,IAAA,EAAA;AACA;;AAzBA;AAjCA","file":"Pages.c0f6e4a4.map","sourceRoot":"../src","sourcesContent":["<template lang=\"pug\">\n.cms-pages\n  h1 Sidor\n  mdc-list(two-line)\n    mdc-list-item(v-for=\"page of pages\", @click=\"editPage(page.slug)\", :text=\"page.label\", :secondary=\"page.published ? 'Published' : 'Not Published'\")\n  mdc-button(@click=\"createDialog\") Ny sida\n\n  mdc-dialog#create-page(ref=\"dialog\", header=\"Skapa en ny sida\", :valid=\"dialogValid\", @accept=\"createPage\")\n    p\n      | Sökvägen måste minst vara 3 tecken långt, vara unikt och tillåtna tecken är \"A-Za-z-/\".\n      | Sidonamnet måste vara minst 10 tecken långt men är behöver inte vara unikt.\n    mdc-textfield(label=\"Slug (sökväg)\", v-model=\"dialog.slug\")\n    mdc-textfield(label=\"Sidonamn\", v-model=\"dialog.label\")\n</template>\n\n<script>\nexport default {\n  name: 'CmsPages',\n  data() {\n    return {\n      pages: [],\n      dialog: {\n        slug: '',\n        label: '',\n      }\n    };\n  },\n  computed: {\n    dialogValid() {\n      const { dialog } = this;\n      // Check if page already exists\n      if(dialog.label.length > 10 && dialog.slug.length > 3) {\n        return !this.pages.some(page => page.slug == dialog.slug);\n      }\n      return false;\n    }\n  },\n\n  async created() {\n    const token = this.$auth.token;\n\n    // Call api function to get current pages\n    try {\n      this.pages = await this.$api('/page');\n    } catch(ex) {\n      this.$snackbar.show(ex.message);\n    }\n  },\n\n  methods: {\n    createDialog() {\n      this.$refs.dialog.open();\n    },\n    async createPage() {\n      const { dialog } = this;\n\n      try {\n        await this.$api(`/page/${dialog.slug}`, {\n          method: 'put',\n          body: {\n            data: { label: dialog.label },\n          },\n        });\n\n\n        dialog.slug = '';\n        dialog.label = '';\n        this.$snackbar.show('Sidan skapades');\n      } catch (ex) {\n        this.$snackbar.show(ex.message);\n      }\n    },\n    editPage(slug) {\n      this.$router.push(`/edit/page/${slug}`);\n    }\n  },\n};\n</script>\n"]}